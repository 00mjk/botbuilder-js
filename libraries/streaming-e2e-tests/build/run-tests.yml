jobs:
  - job: Run_Tests
    steps:
      - task: DownloadPipelineArtifact@2
        inputs:
          artifact: CustomizedReactApp
          path: $(ReactProjectDir)

      - powershell: start powershell {npm start}
        displayName: 'Serve react-app (npm start), opening new console'
        workingDirectory: $(ReactProjectDir)
      
      - powershell: npm install
        displayName: 'npm install in tests directory'
        workingDirectory: $(TestsDir)

      - powershell: Start-Sleep -Seconds 20;
        displayName: 'Allowing React App to serve. Sleeping 20 seconds'

      - powershell: npm test
        displayName: 'Run Tests: npm test'
        workingDirectory: $(TestsDir)